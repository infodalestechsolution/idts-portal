<!DOCTYPE html>
<html lang="en">

<head>
    <title>Schedule Sling Jobs In AEM</title>
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content=" Context Aware Configuration">
    <meta name="keywords"
        content="In AEM, Sling Jobs are a mechanism provided by Apache Sling Job Handling to process background tasks asynchronously and reliably.">
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Schedule Sling Jobs In AEM" />
    <meta property="og:description"
        content="In AEM, Sling Jobs are a mechanism provided by Apache Sling Job Handling to process background tasks asynchronously and reliably." />
    <meta property="og:url" content="https://infodales.com/blogs/slingjobs.html" />
    <meta property="og:site_name" content="Schedule Sling Jobs In AEM" />
    <link rel="stylesheet" href="/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;300;400;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

</head>

<body>

    <!-- Header -->
    <section class="sub-header"
        style="background-image: linear-gradient(rgba(4, 9, 30, 0.5), rgba(4, 9, 30, 0.5)), url('/images/Cover\ Sites.jpg');">
        <nav>
            <a href="/index.html"><img src="/images/infodales/Info Dales Main Logo 03.webp" alt="logo"></a>
            <div class="nav-links" id="navLinks">
                <i class="fa fa-times" onclick="hideMenu()"></i>
                <ul>
                    <li><a href="/index.html">HOME</a></li>
                    <li><a href="/about.html">ABOUT</a></li>
                    <li><a href="/services.html">SERVICES</a></li>
                    <li><a href="/blogs.html">BLOGS</a></li>
                    <li><a href="/career.html">CAREER</a></li>
                    <li><a href="/contact.html">CONTACT</a></li>
                    <ul>
            </div>
            <i class="fa fa-bars" onclick="showMenu()"></i>
        </nav>
    </section>
    <!--  Blog Page Content --->
    <section class="blog-content">
        <div>
            <div class="blog">

                <p style="color: rgb(133, 133, 133); padding: 0 0 10px 0;"><a href="/blogs.html"
                        style="text-decoration: none; cursor: pointer;">Blogs</a> <span> > </span> Schedule Sling Jobs
                    In AEM</p>

                <p class="sitesTag" style="margin-top: 7px; margin-bottom: 7px; font-size: 13px; border-radius: 20px; 
				width: fit-content; padding: 3px 15px;">AEM Sites</p>
                <h1 class="title">Schedule Sling Jobs In AEM</h1>
                <span class="author">Infodales Tech Solutions | </span>
                <span class="date">December 27, 2024</span>

                <div class="share-icons">
                    <a href="https://www.linkedin.com/company/infodales-tech-solution/" target="_blank"
                        class="linkedin-icon"><i class="fa fa-linkedin"></i></a>
                    <a href="mailto:info@infodales.com" target="_blank" class="email-icon"><i
                            class="fa fa-envelope"></i></a>
                </div>

                <hr style="margin: 20px 0 10px 0;">
                <!-- <div class="image-container">
					<img src="images/cover.webp" alt="Image Description">
				</div> -->
                <div class="blog-items">
                    <h3 style="text-align: left; margin: 0px 0">Overview of Sling Jobs in Adobe Experience Manager (AEM)
                    </h3>
                    <p>
                        Apache Sling Jobs are a mechanism in AEM to perform asynchronous tasks reliably. They are built
                        using the Sling Event and Job Handling framework, enabling you to offload tasks like data
                        processing, page replication, or integration workflows that don't need to happen in real-time.In
                        this blog, we will see how to schedule a job in AEM so that it executes at a particular interval
                        of time.</p>
                    <h4 tyle="text-align: left; margin: 0px 0">What is Sling Jobs ?</h4>
                    <p>In AEM, Sling Jobs are a part of the event-driven architecture that enables task scheduling,
                        processing, and management in an asynchronous and persistent manner. They are used to perform
                        long-running or non-blocking tasks like importing data, sending notifications, or cleaning up
                        resources.
                    </p>
                    <h4 tyle="text-align: left; margin: 0px 0">How Sling Jobs Work </h4>
                    <div style=" margin-left: 20px;">
                        <ul style="margin: auto; width: 95%;" class="description-txt">
                            <li>
                                <p> <b>Job Creation</b></p>
                                <ul style="margin: auto; width: 95%;" class="description-txt">
                                    <li>
                                        <p> In AEM, the Sling Job Manager allows you to create jobs using the
                                            JobBuilder. By calling jobManager.createJob(TOPIC), you define the job's
                                            topic (which is essentially the type of job you're creating). The TOPIC is a
                                            unique identifier that helps link the job to a specific Job Consumer that
                                            processes jobs with that topic.
                                            Once the job is created with the topic, you can add additional properties or
                                            parameters (key-value pairs) to specify the task’s details. These properties
                                            are used during job execution to provide any necessary data for processing
                                            the job.
                                        </p>
                                        <p>For e.g Creating a job with a specific topic <br />
                                        <pre
                                            style="margin-bottom: -130px;"><code>JobBuilder jobBuilder = jobManager.createJob("com/example/processFile");</code></pre>
                                        </p>
                                    </li>
                                    <li>
                                        <p><b>Topic</b>: "com/example/processFile" — this identifies the type of
                                            job.<br />
                                            <b>Properties</b> : You can add data that the job consumer will need to
                                            process the job.
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p><b>Job Submission </b></p>
                                <ul style="margin: auto; width: 95%;" class="description-txt">
                                    <li>
                                        <p> After the job is created, it needs to be submitted to the Sling Job Manager.
                                            When a job is submitted, it does not execute immediately but gets added to a
                                            job queue. The Job Manager ensures that the job is stored in the queue with
                                            its associated topic and properties. The queue is responsible for organizing
                                            and scheduling jobs for execution based on priorities, concurrency settings,
                                            and job availability. Submission allows AEM to manage when and how the job
                                            will be processed without blocking other operations.
                                        </p>
                                        <p>
                                        <pre style="margin-bottom: -110px;"><code> jobManager.addJob("com/example/processFile", properties);
                                                </code></pre>
                                        </p>
                                    </li>
                                    <li>
                                        <p><b>Topic</b>: "com/example/processFile" — this identifies the type of
                                            job.<br />
                                            <b>Properties</b> : You can add data that the job consumer will need to
                                            process the job.
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p><b>Job Execution</b> </p>
                                <ul style="margin: auto; width: 95%;" class="description-txt">
                                    <li>
                                        <p>Once a job is queued, Job Consumers are responsible for executing the job.
                                            AEM manages a pool of worker threads that process jobs asynchronously. These
                                            worker threads are part of a dedicated thread pool designed for job
                                            execution, ensuring that long-running tasks don't interfere with the
                                            user-facing application. The Job Consumer—a service listening for specific
                                            topics—picks up jobs from the queue and processes them in the background.
                                            The execution process is decoupled from the main application flow, meaning
                                            it happens in parallel, improving performance and ensuring the system
                                            remains responsive.
                                        </p>
                                        <p>
                                        <pre style="width: 100%; height:100%"><code class="center code-flow" style="width: 80%;">  @Component(service = JobConsumer.class,property = { JobConsumer.PROPERTY_TOPICS + "=com/example/processFile" })
                                                </code></pre>
                                        </p>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <h4 tyle="text-align: left; margin-top: 5px 0">How to create and schedule the sling Job</h4>
                    <p>We can schedule the job at specific intervals of time using job builder andscheduler builder .In
                        the below code we are creating a simple job using the job manager and scheduling that job to
                        execute after every one minute.</p>
                    <pre style="width: 100%; height:100%"><code class="center code-flow" style="width: 80%; height:100%">
                            package com.sample.core.servlets;

                            import org.apache.sling.api.SlingHttpServletRequest;
                            import org.apache.sling.api.SlingHttpServletResponse;
                            import org.apache.sling.api.servlets.SlingAllMethodsServlet;
                            import org.apache.sling.event.jobs.JobBuilder;
                            import org.apache.sling.event.jobs.JobManager;
                            import org.apache.sling.event.jobs.ScheduledJobInfo;
                            import org.osgi.service.component.annotations.Component;
                            import org.osgi.service.component.annotations.Reference;
                            import javax.servlet.Servlet;
                            import javax.servlet.ServletException;
                            import java.io.IOException;
                            import java.util.*;

                            @Component(
                            service = Servlet.class,
                            property = {
                            "sling.servlet.paths=/bin/schedulejob",
                            "sling.servlet.methods=POST"
                            }
                            )
                            public class SampleJobSchedulerServlet extends SlingAllMethodsServlet {
                            private static final String TOPIC = "content/archival/scheduled/job";
                            @Reference
                            JobManager jobManager;

                            @Override
                            protected void doPost(SlingHttpServletRequest request, SlingHttpServletResponse response) throws ServletException, IOException {
                            Collection<ScheduledJobInfo> myJobs = jobManager.getScheduledJobs(TOPIC, 1, null);
                            List<String> listOfString = new ArrayList<>();
                            listOfString.add("custom value");
                            if (myJobs.isEmpty()) {
                               Map<String, Object> map = new HashMap<>();
                               map.put("customParam", "Hello, this is a sample Sling job!");
                               JobBuilder jobBuilder = jobManager.createJob(TOPIC);
                               jobBuilder.properties(map);
                               JobBuilder.ScheduleBuilder scheduleBuilder = jobBuilder.schedule();
                               scheduleBuilder.cron("0 * * * * ?");
                               scheduleBuilder.daily(0, 0);
                               if(scheduleBuilder.add() ==null){
                                  scheduleBuilder.add(listOfString);
                               }
                               else {
                                  response.getWriter().write("Scheduled Job for " +TOPIC);
                               }
                               }
                               }
                               }

                    </code></pre>
                    <p>In the above code, we define a scheduled job by invoking the jobManager.createJob() method and
                        assigning it a topic ("content/archival/scheduled/job"). We then verify if the job is already
                        scheduled by calling jobManager.getScheduledJobs(). If it’s not, we use ScheduleBuilder to
                        configure the job to run daily at midnight and add it to the queue with scheduleBuilder.add().
                    </p>
                    <pre style="width: 100%; height:100%"><code class="center code-flow" style="width: 80%; height:100%">
                        package com.sample.core.jobs;


                        import org.apache.sling.event.jobs.Job;
                        import org.apache.sling.event.jobs.consumer.JobConsumer;
                        import org.osgi.service.component.annotations.Component;
                        import org.slf4j.Logger;
                        import org.slf4j.LoggerFactory;
                        
                        
                        @Component(service = JobConsumer.class, immediate = true,
                              property = {
                                    JobConsumer.PROPERTY_TOPICS + "=" + "content/archival/scheduled/job"
                              })
                        public class SampleJobConsumer implements JobConsumer {
                        private final Logger logger = LoggerFactory.getLogger(getClass());
                        @Override
                        public JobResult process(Job job) {
                           String customParam = (String) job.getProperty("customParam");
                           logger.info("Custom Param: ", customParam);
                           return JobResult.OK;
                        }
                        }

                </code></pre>
                    <p> In the above code, we define a Job Consumer component that listens for jobs on the
                        "content/archival/scheduled/job" topic. When a scheduled job is triggered, this component
                        executes logic. You can access job properties or custom parameters to process the archival task
                        as needed. If the task completes successfully, return JobResult.OK to indicate that the job was
                        successfully executed.
                    </p>
                    <h4 tyle="text-align: left; margin: 0px 0">How to trigger the job</h4>
                    <div style=" margin-left: 20px;">
                        <ul style="margin: auto; width: 95%;" class="description-txt">
                            <li>
                                <p> <b>Test the Servlet:</b></p>
                                <ul style="margin: auto; width: 95%;" class="description-txt">
                                    <li>
                                        <p> Use Postman to send a request to the path /bin/schedulejob.
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p><b>Check the Response : </b></p>
                                <ul style="margin: auto; width: 95%;" class="description-txt">
                                    <li>
                                        <p> If the status code is 200, you will receive the response:
                                            "Scheduled Job for content/archival/scheduled/job".
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p><b>Navigate to slingevent</b> </p>
                                <ul style="margin: auto; width: 95%;" class="description-txt">
                                    <li>
                                        <p>Go to http://localhost:4502/system/console/slingevent
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p><b>Search for your Job Topic Name</b> </p>
                                <ul style="margin: auto; width: 95%;" class="description-txt">
                                    <li>
                                        <p>for e.g content/archival/scheduled/job you will find you job has been
                                            schedule under scheduled job section
                                        </p>
                                        <div class="migration-journey-images">
                                            <img src="../images/slingjobs/cronjob.webp" alt="cron-job-image" />
                                        </div>
                                    </li>
                                    <li>
                                        <p>Also you will find logs of when it was created and finished
                                        </p>
                                        <div class="migration-journey-images">
                                            <img src="../images/slingjobs/slingstatistics.webp"
                                                alt="sling-statistics-image" />
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p><b>Navigate to Logs:</b> </p>
                                <ul style="margin: auto; width: 95%;" class="description-txt">
                                    <li>
                                        <p>Go to http://localhost:4502/system/console/slinglog.
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p><b>Create Logger for Job Consumer:</b> </p>
                                <ul style="margin: auto; width: 95%;" class="description-txt">
                                    <li>
                                        <p>Set up a logger for the job consumer in the Sling log.
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p><b>Verify Job Execution :</b> </p>
                                <ul style="margin: auto; width: 95%;" class="description-txt">
                                    <li>
                                        <p>You will observe that the job runs repeatedly according to the schedule
                                            specified in the cron expression.
                                        </p>
                                        <div class="migration-journey-images">
                                            <img src="../images/slingjobs/slinglogs.webp" alt="sling-logs-image" />
                                        </div>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <hr style="margin-top: 30px;">

                <div class="author-details">
                    <div id="like-icon" class="like-icon">
                        <span id="like-count" class="like-count">0</span>
                        <span id="like-btn" class="like-btn">
                            <img src="/images/clap.webp" alt="Like">
                        </span>
                    </div>
                    <div>
                        <span class="author-name">Yash Sakharkar | </span>
                        <span class="author-designation">AEM Developer</span>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <div class="social-icons">

        <a href="https://www.linkedin.com/company/infodales-tech-solution/" class="linkedin"><img
                src="/images/linkedin.webp" alt="LinkedIn"></a>
        <a href="mailto:info@infodales.com" class="email"><img src="/images/email.webp" alt="Email"></a>
    </div>

    <!--  Footer --->
    <div class="copyright-area">
        <div class="footer">
            <div class="row" style="margin-top: 0px;">
                <div class="col-xl-4 col-lg-4 text-center text-lg-left">
                    <div class="copyright-text">
                        <p>Copyright &copy; 2023, All Right Reserved <a href="/index.html">Infodales Tech
                                Solution</a></p>
                    </div>
                </div>

                <div class="col-xl-4 col-lg-4 d-none d-lg-block text-right">
                    <div class="footer-menu" style="margin-top:10px;">
                        <ul>
                            <li><a href="/index.html">Home</a></li>
                            <li><a href="/about.html">About</a></li>
                            <li><a href="/contact.html">Contact</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!--- Java Script-->
    <script>
        var navLinks = document.getElementById("navLinks");

        function showMenu() {
            navLinks.style.right = "0";
        }

        function hideMenu() {
            navLinks.style.right = "-200px";
        }

        document.addEventListener("DOMContentLoaded", () => {
            const likeBtn = document.getElementById('like-btn');
            const likeCount = document.getElementById('like-count');

            let count = parseInt(localStorage.getItem('clapCount')) || 0;
            likeCount.textContent = count;

            likeBtn.addEventListener('click', () => {
                count++;
                likeCount.textContent = count;
                localStorage.setItem('clapCount', count);

                const likeAnimation = document.createElement('div');
                likeAnimation.classList.add('like-animation');
                likeAnimation.innerHTML = '🎉';
                document.getElementById('like-icon').appendChild(likeAnimation);
                likeAnimation.addEventListener('animationend', () => {
                    likeAnimation.remove();
                });
            });
        });

        // function relatedFilter() {
        // 	var retString = localStorage.getItem("allBlogs");
        // 	console.log(retString);
        // }


    </script>

</body>

</html>